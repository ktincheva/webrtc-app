<!DOCTYPE html>
<html ng-app="app">
<head>
  <meta charset="utf-8">

 
  <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="bower_components/angular-smilies/dist/angular-smilies-embed.min.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div class="container" ng-controller="controller">
  <hr />
    <h4>Triggers</h4>
    <p>
    </p>
    <input type="text" ng-model="message" value="Click me!" uib-popover="I appeared on focus! Click away and I'll vanish..."  popover-trigger="focus" class="form-control">
<button class="smiley-smile smilies-selector"  smilies-selector="message" uib-popover-template="dynamicPopover.templateUrl" popover-title="{{dynamicPopover.title}}"   popover-trigger="focus" class="form-control">
</div>

<script src="bower_components/angular/angular.min.js" type="text/javascript"></script>
<script src="bower_components/angular-sanitize/angular-sanitize.min.js" type="text/javascript"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js" type="text/javascript"></script>

<!-- <script src="../bower_components/angular-strap/dist/angular-strap.min.js"></script> -->
<!-- <script src="../bower_components/angular-strap/dist/angular-strap.tpl.min.js"></script> -->



<script>
  var app = angular.module('app', [
    'ngSanitize',
    'ui.bootstrap', // Angular UI Bootstrap
    //'mgcrea.ngStrap', // Angular Strap
    'angular-smilies'
  ]);

  app.controller('controller', function($scope) {
     $scope.dynamicPopover = {
    content: 'Hello, World!',
    templateUrl: 'myPopoverTemplate.html',
    title: 'Title'
  };

  $scope.placement = {
    options: [
      'top',
      'top-left',
      'top-right',
      'bottom',
      'bottom-left',
      'bottom-right',
      'left',
      'left-top',
      'left-bottom',
      'right',
      'right-top',
      'right-bottom'
    ],
    selected: 'top'
  };
  });
  var
    main = "smile",
    smilies = ["biggrin","confused","cool","cry","eek","evil","like","lol","love","mad","mrgreen","neutral","question","razz","redface","rolleyes","sad","smile","surprised","thumbdown","thumbup","twisted","wink"],
    shorts = {":D":"biggrin",":-D":"biggrin",":S":"confused",":-S":"confused",";(":"cry",";-(":"cry","OO":"eek","<3":"like","^^":"lol",":|":"neutral",":-|":"neutral",":P":"razz",":-P":"razz",":(":"sad",":-(":"sad",":)":"smile",":-)":"smile",":O":"surprised",":-O":"surprised",";)":"wink",";-)":"wink"}
  
  angular.module("app")
        .directive('smiliesSelector', ['$timeout', function($timeout) {
        var templateUrl;
        try {
            angular.module('ui.bootstrap.popover');
            templateUrl = 'template/smilies/button-a.html';
        }
        catch(e) {
            try {
                angular.module('mgcrea.ngStrap.popover');
                templateUrl = 'template/smilies/button-b.html';
            }
            catch(e) {
                console.error('No Popover module found');
                return {};
            }
        }

        return {
            restrict: 'A',
            templateUrl: templateUrl,
            scope: {
                source: '=smiliesSelector',
                placement: '@smiliesPlacement',
                title: '@smiliesTitle'
            },
            link: function($scope, el) {
                $scope.smilies = smilies;

                $scope.append = function(smiley) {
                    $scope.source+= ' :'+smiley+': ';

                    $timeout(function() {
                        el.children('i').triggerHandler('click'); // close the popover
                    });
                };
            }
        };

    }])
     /* helper directive for input focusing */
    .directive('focusOnChange', function() {
        return {
            restrict: 'A',
            link: function($scope, el, attrs) {
                $scope.$watch(attrs.focusOnChange, function() {
                    el[0].focus();
                });
            }
        };
    })
    /* popover template */
    .run(['$templateCache', function($templateCache) {
        // use ng-init because popover-template only accept a variable
        $templateCache.put('template/smilies/button-a.html',
            '<i class="smiley-'+ main +' smilies-selector" '+
                'ng-init="smiliesTemplate = \'template/smilies/popover-a.html\'" '+
                'popover-template="smiliesTemplate" '+
                'popover-placement="{{!placement && \'left\' || placement}}" '+
                'popover-title="{{title}}"></i>'
        );
        $templateCache.put('template/smilies/button-b.html',
            '<i class="smiley-'+ main +' smilies-selector" bs-popover '+
                'data-template="template/smilies/popover-b.html" '+
                'data-placement="{{!placement && \'left\' || placement}}" '+
                'title="{{title}}"></i>'
        );
        $templateCache.put('template/smilies/popover-a.html',
            '<div ng-model="smilies" class="smilies-selector-content">'+
              '<i class="smiley-{{smiley}}" ng-repeat="smiley in smilies" ng-click="append(smiley)"></i>'+
            '</div>'
        );
        $templateCache.put('template/smilies/popover-b.html',
            '<div class="popover" tabindex="-1">'+
                '<div class="arrow"></div>'+
                '<h3 class="popover-title" ng-bind-html="title" ng-show="title"></h3>'+
                '<div class="popover-content">'+
                    $templateCache.get('template/smilies/popover-a.html') +
                '</div>'+
            '</div>'
        );
    }]);
</script>
   <script type="text/ng-template" id="myPopoverTemplate.html">
        <i class="smiley-'+ main +' smilies-selector" '+
                'ng-init="smiliesTemplate = \'template/smilies/popover-a.html\'" '+
                'popover-template="smiliesTemplate" '+
                'popover-placement="{{!placement && \'left\' || placement}}" '+
                'popover-title="{{title}}"></i>
    </script>
</body>
</html>